{
  "name": "Identity Service Quality Gates",
  "version": "1.0.0",
  "criteria": {
    "code_quality": {
      "linting": {
        "tool": "eslint",
        "config": "eslint.config.ci.mjs",
        "max_errors": 0,
        "max_warnings": 50,
        "description": "Strict linting rules for production code, relaxed for tests"
      },
      "formatting": {
        "tool": "prettier",
        "enforce": true,
        "description": "Consistent code formatting across the project"
      },
      "type_safety": {
        "tool": "typescript",
        "strict_mode": true,
        "no_implicit_any": true,
        "description": "Strong type safety with minimal any usage"
      }
    },
    "testing": {
      "unit_tests": {
        "minimum_coverage": {
          "statements": 30,
          "branches": 30,
          "functions": 20,
          "lines": 30
        },
        "required_pass_rate": 100,
        "description": "All unit tests must pass with minimum coverage thresholds"
      },
      "integration_tests": {
        "minimum_pass_rate": 85,
        "critical_flows_pass_rate": 100,
        "description": "E2E tests with high pass rate, critical flows must pass"
      }
    },
    "security": {
      "dependency_audit": {
        "max_severity": "moderate",
        "auto_fix": true,
        "description": "No high or critical security vulnerabilities"
      },
      "code_analysis": {
        "no_hardcoded_secrets": true,
        "secure_coding_practices": true,
        "description": "Security best practices enforced"
      }
    },
    "database": {
      "migrations": {
        "must_run_successfully": true,
        "rollback_tested": true,
        "description": "Database migrations must be reversible and tested"
      },
      "schema_validation": {
        "foreign_keys_enforced": true,
        "indexes_optimized": true,
        "description": "Database schema follows best practices"
      }
    },
    "performance": {
      "build_time": {
        "max_duration_seconds": 120,
        "description": "Build should complete within reasonable time"
      },
      "test_execution": {
        "unit_tests_max_duration_seconds": 60,
        "e2e_tests_max_duration_seconds": 300,
        "description": "Tests should execute efficiently"
      }
    }
  },
  "enforcement": {
    "pre_commit": [
      "formatting",
      "linting",
      "unit_tests"
    ],
    "pre_push": [
      "all_unit_tests",
      "type_checking",
      "security_audit"
    ],
    "ci_pipeline": [
      "all_criteria"
    ]
  },
  "exceptions": {
    "test_files": {
      "linting_relaxed": true,
      "any_usage_allowed": "limited",
      "description": "Test files have relaxed rules for mocking and testing"
    },
    "legacy_code": {
      "gradual_improvement": true,
      "description": "Legacy code improvements tracked separately"
    }
  }
}